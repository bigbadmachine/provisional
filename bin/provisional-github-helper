#!/usr/bin/env ruby

require 'net/http'
require 'yaml'

repository_name = ARGV[0]

begin
  github_config = YAML.load_file(ARGV[1])
rescue
  raise ArgumentError, "could not be loaded: #{ARGV[1]}"
end

Net::HTTP.post_form URI.parse('http://github.com/repositories'), {
  'login' => github_config['login'],
  'token' => github_config['token'],
  'repository[name]' => repository_name,
  'repository[description]' => repository_name
}
