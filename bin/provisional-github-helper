#!/usr/bin/env ruby

require 'rubygems'
require 'mechanize'

repository_name = ARGV[0]
github_username = ARGV[1]
github_password = ARGV[2]

agent                                    = WWW::Mechanize.new
login_page                               = agent.get('https://github.com/login')
login_form                               = login_page.forms[0]
login_form['login']                      = github_username
login_form['password']                   = github_password
dashboard_page                           = agent.submit(login_form)
new_repo_page                            = agent.click(dashboard_page.link_with(:text => '(create a new one)'))
new_repo_form                            = new_repo_page.forms[2]
new_repo_form['repository[name]']        = repository_name
new_repo_form['repository[description]'] = repository_name
agent.submit(new_repo_form)
